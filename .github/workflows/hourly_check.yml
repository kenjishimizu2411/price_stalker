name: PriceStalker Robot ü§ñ

# QUANDO RODAR?
on:
  schedule:
    # Cron Job: Roda no minuto 0 de cada hora (0 * * * *)
    - cron: '0 * * * *'
  # Permite rodar manualmente clicando num bot√£o (pra testar)
  workflow_dispatch:

# O QUE FAZER?
jobs:
  run-scraper:
    runs-on: ubuntu-latest # Aluga um computador Linux na hora

    steps:
      # 1. Baixa seu c√≥digo
      - name: Checkout do c√≥digo
        uses: actions/checkout@v3

      # 2. Instala Python
      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      # 3. Instala as bibliotecas
      - name: Instalar depend√™ncias
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      # 4. Roda o Scraper
      # Onde a m√°gica acontece. Ele injeta as senhas secretas como vari√°veis de ambiente
      - name: Rodar o Main.py
        env:
          DATABASE_URL: ${{ secrets.DATABASE_URL }}
          WHATSAPP_API_KEY: ${{ secrets.WHATSAPP_API_KEY }}
        run: python src/main.py